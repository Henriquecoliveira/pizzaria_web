-- CRIAÇÃO DO BANCO DE DADOS DA PIZZARIA
CREATE DATABASE PIZZARIA

-- SELECIONA O BD
USE PIZZARIA

-- CRIAÇÃO DA TABELA CLIENTES
-- A TABELA CLIENTES NÃO ESTÁ PRESENTE NOS SCRIPTS DE CADASTRAR PIZZAS
CREATE TABLE CLIENTES (
    USUARIO_ID  INT IDENTITY(1,1) NOT NULL, -- IDENTITY (1,1) INICIA NO 1 E ADICIONA 1 A CADA LINHA, ASSIM GERANDO ID'S CRESCENTES
    EMAIL       VARCHAR(50) UNIQUE NOT NULL, -- UNIQUE POIS SÓ VAI PODER HAVER 1 USUÁRIO COM ESTE E-MAIL
    USUARIO     VARCHAR(100) NOT NULL, -- NOME DA PESSOA
    SENHA       VARCHAR(30) NOT NULL, -- SENHA EM ATÉ 30 POR QUE É O LOGIN DE UMA PIZZARIA, NÃO DE UM BANCO E O BD AGRADECE
    CPF         VARCHAR(11) NOT NULL,
    TELEFONE    VARCHAR(15) NOT NULL, -- EXEMPLO: (11)99999-9999
    USER_LEVEL  VARCHAR(1) NOT NULL -- DEFINE O NÍVEL DO USUÁRIO NA PÁGINA CASO QUEIRAMOS ADICIONAR ALGUMA FEATURE FUTURA

    CONSTRAINT PK_USUARIO_ID PRIMARY KEY(USUARIO_ID)
)

-- ADICIONANDO UM REGISTRO PARA TESTES
INSERT INTO CLIENTES VALUES (
    'henrique@gmail.com',
    'Henrique Cordeiro de Oliveira',
    '0',
    '11111111111',
    '(11)99999-9999',
    '1'
)

-- ADICIONANDO UM USUÁRIO ADMINISTRATIVO
INSERT INTO CLIENTES VALUES (
    'admin@gmail.com',
    'admin',
    'admin123',
    '99999999999',
    '(11)11111-1112',
    '2'
)

-- ADICIONANDO 10 REGISTROS PARA TESTES TAMBÉM
INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('maria.souza@gmail.com', 'Maria Souza', '1234', '12345678901', '(11)91234-5678', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('joao.silva@gmail.com', 'João Silva', 'abcd', '23456789012', '(21)98888-1111', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('ana.lima@gmail.com', 'Ana Lima', 'senha1', '34567890123', '(31)97777-2222', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('carlos.pereira@gmail.com', 'Carlos Pereira', 'xyz123', '45678901234', '(41)96666-3333', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('juliana.martins@gmail.com', 'Juliana Martins', 'pass123', '56789012345', '(51)95555-4444', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('rodrigo.alves@gmail.com', 'Rodrigo Alves', 'qwerty', '67890123456', '(61)94444-5555', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('patricia.ferreira@gmail.com', 'Patricia Ferreira', 'abc123', '78901234567', '(71)93333-6666', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('lucas.oliveira@gmail.com', 'Lucas Oliveira', 'senha321', '89012345678', '(81)92222-7777', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('mariana.ribeiro@gmail.com', 'Mariana Ribeiro', 'minhasenha', '90123456789', '(91)91111-8888', '1');

INSERT INTO CLIENTES (EMAIL, USUARIO, SENHA, CPF, TELEFONE, USER_LEVEL) VALUES
('eduardo.santos@gmail.com', 'Eduardo Santos', '123abc', '01234567890', '(85)90000-9999', '1');

-- CRIAÇÃO DA TABELA PIZZA

CREATE TABLE PIZZA (
    PIZZA_ID     INT IDENTITY(1,1) NOT NULL, -- INICIA NO 1 E ADICIONA MAIS 1 A CADA LINHA
    PIZZA        VARCHAR(40), -- EXEMPLO: CALABRESA, MUSSARELA
    INGREDIENTES VARCHAR(255), -- "Molho de tomate, queijo, pepperoni e azeitonas." -- exemplo do site
    PRECO        DECIMAL(5,2) NOT NULL,
    IMAGEM_URL   VARCHAR(255)

    CONSTRAINT PK_PIZZA_ID PRIMARY KEY(PIZZA_ID)
)

SELECT *
FROM CLIENTES

CREATE TABLE PEDIDO (
    PEDIDO_ID           INT IDENTITY(1,1) NOT NULL,
    USUARIO_ID          INT NOT NULL,
    DATA_HORA_PEDIDO    DATETIME2 NOT NULL DEFAULT SYSDATETIME(),

    CONSTRAINT PK_PEDIDO PRIMARY KEY (PEDIDO_ID),
    CONSTRAINT FK_PEDIDO_CLIENTE FOREIGN KEY (USUARIO_ID)
        REFERENCES CLIENTES(USUARIO_ID)
)

CREATE TABLE PEDIDO_ITENS (
    ITEM_ID     INT IDENTITY(1,1) NOT NULL,
    PEDIDO_ID   INT NOT NULL,
    ALIMENTO    VARCHAR(40) NOT NULL,
    PRECO       DECIMAL(10,2) NOT NULL,

    CONSTRAINT PK_PEDIDO_ITENS PRIMARY KEY (ITEM_ID),
    CONSTRAINT FK_ITEM_PEDIDO FOREIGN KEY (PEDIDO_ID)
        REFERENCES PEDIDO(PEDIDO_ID)
)

ALTER TABLE PEDIDO
ADD FORMA_DE_PAGAMENTO VARCHAR(30) NOT NULL;

ALTER TABLE PEDIDO
ADD ENDERECO VARCHAR(255) NOT NULL;

SELECT *
FROM PIZZA

-- INSERTS DE PEDIDOS PARA TESTES

-- 1
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (1, '2024-07-12 19:45:00', 'Crédito', 'Rua das Flores, 123 - São Paulo');

-- 2
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (3, '2024-08-03 21:10:00', 'Débito', 'Av. Central, 888 - Belo Horizonte');

-- 3
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (5, '2024-08-29 20:30:00', 'Dinheiro', 'Rua Almeida, 45 - Curitiba');

-- 4
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (2, '2024-09-11 18:50:00', 'Crédito', 'Rua do Comércio, 999 - Rio de Janeiro');

-- 5
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (7, '2024-09-24 22:05:00', 'Débito', 'Rua das Laranjeiras, 201 - Recife');

-- 6
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (4, '2024-10-02 19:00:00', 'Débito', 'Av. Paulista, 1500 - São Paulo');

-- 7
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (10, '2024-10-19 20:40:00', 'Dinheiro', 'Rua XV de Novembro, 332 - Curitiba');

-- 8
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (6, '2024-10-31 21:55:00', 'Crédito', 'Rua Azul, 11 - Salvador');

-- 9
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (8, '2024-11-07 19:20:00', 'Dinheiro', 'Travessa Lima, 200 - Porto Alegre');

-- 10
INSERT INTO PEDIDO (USUARIO_ID, DATA_HORA_PEDIDO, FORMA_DE_PAGAMENTO, ENDERECO)
VALUES (9, '2024-11-21 22:10:00', 'Crédito', 'Rua Esperança, 67 - Belém');

-- Pedido 1
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(1, 'Americana', 34.90),
(1, 'Pizza de Queijo', 28.90);

-- Pedido 2
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(2, 'Pizza Vegana', 30.90);

-- Pedido 3
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(3, 'Pizza Italiana', 32.90),
(3, 'Americana', 34.90);

-- Pedido 4
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(4, 'Pizza Moda da Casa', 33.90);

-- Pedido 5
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(5, 'Pizza de Queijo', 28.90),
(5, 'Pizza Vegana', 30.90);

-- Pedido 6
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(6, 'Americana', 34.90);

-- Pedido 7
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(7, 'Pizza Italiana', 32.90),
(7, 'Pizza Moda da Casa', 33.90);

-- Pedido 8
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(8, 'Pizza Vegana', 30.90);

-- Pedido 9
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(9, 'Pizza de Queijo', 28.90),
(9, 'Pizza Italiana', 32.90);

-- Pedido 10
INSERT INTO PEDIDO_ITENS (PEDIDO_ID, ALIMENTO, PRECO)
VALUES 
(10, 'Pizza Moda da Casa', 33.90);
